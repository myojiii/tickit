<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>TickIT | Ticket Details</title>
  <link rel="stylesheet" href="/styles/staff.css">
  <link rel="stylesheet" href="/styles/details.css">
</head>
<body>
  <div class="layout">
    <aside class="sidebar">
      <!-- Toggle Button -->
      <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle sidebar">
        <svg viewBox="0 0 24 24" class="toggle-icon">
          <path d="M15 18l-6-6 6-6"></path>
        </svg>
      </button>

      <div class="sidebar-top">
        <div class="brand">
          <img src="/assets/logo.png" alt="TickIT logo" class="logo">
          <div class="brand-text">
            <div class="brand-name">TickIT</div>
            <div class="brand-sub">Ticketing System</div>
          </div>
        </div>

        <nav class="nav-menu">
          <button class="nav-btn active" type="button" onclick="window.location.href='/staff'" data-tooltip="Manage Tickets">
            <span class="nav-icon" aria-hidden="true">
              <svg viewBox="0 0 24 24">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8l-6-6z"/>
                <path d="M14 2v6h6"/>
                <path d="M16 13H8"/>
                <path d="M16 17H8"/>
                <path d="M10 9H8"/>
              </svg>
            </span>
            <span class="nav-text">Manage Tickets</span>
          </button>
        </nav>
      </div>

      <button class="logout-btn" id="logout-btn" type="button">
        <span class="logout-icon">
          <svg viewBox="0 0 24 24">
            <path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4"/>
            <polyline points="16 17 21 12 16 7"/>
            <line x1="21" y1="12" x2="9" y2="12"/>
          </svg>
        </span>
        <span class="logout-text">Logout</span>
      </button>
    </aside>

    <section class="content details">
      <header class="topbar">
        <button class="icon-btn" type="button" aria-label="Back" onclick="window.location.href='/staff'">
          <svg viewBox="0 0 24 24" aria-hidden="true">
            <path d="m14.25 6-6 6 6 6 1.06-1.06L10.37 12l4.94-4.94L14.25 6Z"></path>
          </svg>
        </button>

        <div class="topbar-actions">
          <button class="bell-btn" id="bell-btn" aria-label="Notifications">
            <svg viewBox="0 0 24 24">
              <path d="M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.64 5.36 6 7.93 6 11v5l-2 2v1h16v-1l-2-2z"/>
            </svg>
            <span class="bell-badge" id="bell-badge">0</span>
          </button>
          <div class="notifications-panel hidden" id="notifications-panel">
            <div class="notifications-header">
              <h3>Notifications</h3>
              <div class="notifications-header-actions">
                <button class="mark-all-read-btn" id="mark-all-read-btn" aria-label="Mark all as read">
                  <svg viewBox="0 0 24 24"><path d="M9 16.17L4.83 12l-1.42 1.41L9 19 21 7l-1.41-1.41L9 16.17z"/></svg>
                </button>
                <button class="close-notifications" id="close-notifications" aria-label="Close">
                  <svg viewBox="0 0 24 24"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
                </button>
              </div>
            </div>
            <div class="notifications-list" id="notifications-list">
              <p class="empty-state">No notifications</p>
            </div>
          </div>
        </div>
      </header>

      <div class="details-wrapper">
        <div class="scroll-area">
          <section class="details-card hero-card">
            <div class="hero-header">
              <div class="hero-id" id="hero-id">TKT-</div>
              <span class="pill" id="hero-status">-</span>
              <span class="pill" id="hero-priority">-</span>
            </div>
            <h1 class="hero-title" id="hero-title">Loading...</h1>
            <p class="hero-desc" id="hero-desc">
              Loading ticket details... Check browser console for details.
            </p>
            <p id="debug-info" style="font-size: 12px; color: #999; margin-top: 10px;"></p>
            <button class="primary-btn" type="button" id="toggle-convo">View Conversation</button>
          </section>

          <section class="details-grid">
          <article class="details-card">
            <header class="details-head">
              <span class="head-icon">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M12 11.5a3.5 3.5 0 1 0 0-7 3.5 3.5 0 0 0 0 7Zm0 1.5c-3.04 0-5.5 1.9-5.5 4.25 0 .41.34.75.75.75h9.5a.75.75 0 0 0 .75-.75C17.5 14.9 15.04 13 12 13Z"></path>
                </svg>
              </span>
              <div class="head-title">Contact Information</div>
            </header>
            <div class="detail-row">
              <div class="detail-label">Name</div>
              <div class="detail-value" id="detail-client-name">-</div>
            </div>
            <div class="detail-row">
              <div class="detail-label">Email</div>
              <div class="detail-value">
                <span class="inline-icon">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M4.5 5.75h15a.75.75 0 0 1 .75.75v11a.75.75 0 0 1-.75.75h-15a.75.75 0 0 1-.75-.75v-11a.75.75 0 0 1 .75-.75Zm0-1.5A2.25 2.25 0 0 0 2.25 6.5v11A2.25 2.25 0 0 0 4.5 19.75h15A2.25 2.25 0 0 0 21.75 17.5v-11A2.25 2.25 0 0 0 19.5 4.25h-15Z"></path>
                    <path d="m3.78 7.3 7.86 5.25a.75.75 0 0 0 .84 0L20.34 7.3a.75.75 0 1 0-.84-1.2L11.98 10.9 4.62 6.1a.75.75 0 1 0-.84 1.2Z"></path>
                  </svg>
                </span>
                <span id="detail-client-email">-</span>
              </div>
            </div>
            <div class="detail-row">
              <div class="detail-label">Phone</div>
              <div class="detail-value">
                <span class="inline-icon">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M6.54 4a1.5 1.5 0 0 1 1.5-1.5H10a1.5 1.5 0 0 1 1.5 1.5v1A1.5 1.5 0 0 1 10 6.5H9.5a1 1 0 0 0-.96 1.28c.22.76.59 1.62 1.12 2.55.46.82 1 1.64 1.57 2.41a1 1 0 0 0 1.36.24l.67-.45a1.5 1.5 0 0 1 1.9.18l1.3 1.3a1.5 1.5 0 0 1 0 2.12l-.7.7a2.5 2.5 0 0 1-3.33.16c-.89-.7-1.8-1.57-2.7-2.53-.9-.96-1.74-1.97-2.45-2.97-.7-.99-1.32-2.04-1.77-3.06A2.5 2.5 0 0 1 6.5 7.73V6a2 2 0 0 1 .04-.4Z"></path>
                  </svg>
                </span>
                <span id="detail-client-phone">-</span>
              </div>
            </div>
          </article>

          <article class="details-card">
            <header class="details-head">
              <span class="head-icon info">
                <svg viewBox="0 0 24 24" aria-hidden="true">
                  <path d="M12 3.25A8.75 8.75 0 1 0 20.75 12 8.76 8.76 0 0 0 12 3.25Zm0 1.5A7.25 7.25 0 1 1 4.75 12 7.26 7.26 0 0 1 12 4.75Z"></path>
                  <path d="M12 10a.75.75 0 0 0-.75.75v4a.75.75 0 0 0 1.5 0v-4A.75.75 0 0 0 12 10Zm0-2.5a.88.88 0 1 0 0 1.76.88.88 0 0 0 0-1.76Z"></path>
                </svg>
              </span>
              <div class="head-title">Key Information</div>
            </header>
            <div class="detail-row">
              <div class="detail-label">Assigned to:</div>
              <div class="detail-value" id="detail-assigned-staff">-</div>
            </div>
            <div class="detail-row">
              <div class="detail-label">Status</div>
              <div class="select-box" id="detail-status-box">
                <span id="detail-status">-</span>
                <svg class="chevron" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="m8.5 10 3.5 3.5L15.5 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                </svg>
              </div>
            </div>
            <div class="detail-row">
              <div class="detail-label">Created Date</div>
              <div class="detail-value">
                <span class="inline-icon">
                  <svg viewBox="0 0 24 24" aria-hidden="true">
                    <path d="M12 3.25a8.75 8.75 0 1 0 8.75 8.75A8.76 8.76 0 0 0 12 3.25Zm0 1.5A7.25 7.25 0 1 1 4.75 12 7.26 7.26 0 0 1 12 4.75Z"></path>
                    <path d="M12 7.75a.75.75 0 0 0-.75.75v3.3a.75.75 0 0 0 .44.68l2.28 1a.75.75 0 0 0 .6-1.38l-1.82-.8V8.5A.75.75 0 0 0 12 7.75Z"></path>
                  </svg>
                </span>
                <span id="detail-created-date">-</span>
              </div>
            </div>
          </article>

          <article class="details-card">
            <header class="details-head">
              <div class="head-title">Additional Information</div>
            </header>
            <div class="detail-row">
              <div class="detail-label">Priority</div>
              <div class="select-box" id="detail-priority-box">
                <span id="detail-priority">-</span>
                <svg class="chevron" viewBox="0 0 24 24" aria-hidden="true">
                  <path d="m8.5 10 3.5 3.5L15.5 10" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round"></path>
                </svg>
              </div>
            </div>
            <div class="detail-row">
              <div class="detail-label">Category</div>
              <div class="detail-value" id="detail-category">-</div>
            </div>
          </article>
        </section>
        </div>

        <aside class="conversation-panel" id="conversation-card">
          <div class="conversation-panel-header">
            <div class="conv-title">Conversation</div>
            <button class="close-panel-btn" id="close-panel-btn" aria-label="Close conversation">
              <svg viewBox="0 0 24 24" aria-hidden="true">
                <path d="m7 7 10 10M17 7 7 17" stroke="currentColor" stroke-width="2" stroke-linecap="round"></path>
              </svg>
            </button>
          </div>
          <div class="messages">
            <!-- Messages will be loaded dynamically here -->
          </div>
          <div class="composer">
            <textarea id="message-input" placeholder="Type your reply..." rows="3"></textarea>
            <div class="composer-actions">
              <input type="file" id="file-input" style="display: none;" multiple accept="image/*,.pdf,.doc,.docx,.txt">
              <button type="button" class="attach-btn" id="attach-btn">
                <img src="/assets/attach.png" alt="Attach" style="width:16px;height:16px;filter: grayscale(100%);">
              </button>
              <button type="button" class="send-btn" id="send-btn">
                Send
              </button>
            </div>
            <div class="attachments-preview" id="attachments-preview"></div>
          </div>
        </aside>
      </div>
    </section>
  </div>

  <div class="notification-container" id="notification-container"></div>

  <script src="/scripts/details.js"></script>
</body>
</html>
